{% extends 'base.html' %}
{% load static %}

{% block content %}
    <link href="{% static 'product/css/product.css' %}" rel="stylesheet">
    <link href="{% static 'product/addslider/addSlider.min.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <style>
        #custom-handle {
            width: 3em;
            height: 1.6em;
            top: 50%;
            margin-top: -.8em;
            text-align: center;
            line-height: 1.6em;
        }
    </style>

    <section>
        <div class="container">
            <div class="col-md-2 filter">
                <div class="row">
                    <h3>Filter</h3>
                    <button class="btn btn-danger">Clear</button>
                </div>
                <br><br>
                <button id="size_s" data-id="S"><a href="#">S</a></button>
                <button id="size_m" data-id="M"><a href="#">M</a></button>
                <button id="size_l" data-id="L"><a href="#">L</a></button>
                <button id="size_xl" data-id="XL"><a href="#">XL</a></button>
                <button id="size_xxl" data-id="XXL"><a href="#">XXL</a></button>


                <div>
                    <h3>Max Price</h3>
                    {#                    <input#}
                    {#                            id="max_price"#}
                    {#                            data-addui='slider'#}
                    {#                            data-value='2000'#}
                    {#                            data-fontsize='14'#}
                    {#                            data-step='1'#}
                    {#                            data-min='0'#}
                    {#                            data-id="MAX"#}
                    {#                            data-max={{ max_price.price__max }}#}
                    {##}
                    {##}
                    {#                    >#}
                    <div id="slider">
                        <div id="custom-handle" class="ui-slider-handle"></div>
                    </div>


                </div>


                <div>
                    <input type="text">

                </div>


            </div>

            <div class="col-md-10 text-center product">
                <div class="row" id="product-content">
                    Some Description here
                    {% include 'pages/product/item/product_item.html' %}
                </div>
            </div>


        </div>

    </section>

    <script src="{% static 'product/addslider/addSlider.js' %}"></script>

    <script src="{% static 'product/addslider/Obj.min.js' %}"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
        $(function () {
            var handle = $("#custom-handle");
            $("#slider").slider({
                max: {{ max_price.price__max }},
                min: 0,

                create: function () {

                    handle.text($(this).slider("value"));
                },
                slide: function (event, ui) {
                    handle.text(ui.value);


                },
                stop: function (event, ui) {
                    console.log(ui.value);
                    $('#product-content').html("");
                    $.ajax({
                        url: "{% url 'product:filtered' %}",
                        type: 'POST',
                        data: {button_id: ui.value},

                        success: function (json) {
                            if (json.content['result']) {
                                console.log('refresd content');
                                $('#product-content').append(json.content['rendered']);
                            } else {
                                console.log('Fail to filter');
                            }
                        }
                    });
                }

            });
        });


        $('button').on('click', function () {
            $('#product-content').html("");
            var element = $(this);

            $.ajax({
                url: "{% url 'product:filtered' %}",
                type: 'POST',
                data: {button_id: element.attr("data-id")},

                success: function (json) {
                    if (json.content['result']) {
                        console.log('refresd content');
                        $('#product-content').append(json.content['rendered']);
                    } else {
                        console.log('Fail to filter');
                    }
                }
            });
        });
        {#        $('input').on('change',function () {#}
        {#            console.log('Changing');#}
        {#            $('#product-content').html("");#}
        {#            var element = $(this);#}
        {##}
        {#            $.ajax({#}
        {#                url: "{% url 'product:filtered' %}",#}
        {#                type: 'POST',#}
        {#                data: {button_id: element.val()},#}
        {##}
        {#                success: function (json) {#}
        {#                    if (json.content['result']) {#}
        {#                        console.log('refresd content');#}
        {#                        $('#product-content').append(json.content['rendered']);#}
        {#                    } else {#}
        {#                        console.log('Fail to filter');#}
        {#                    }#}
        {#                }#}
        {#            });#}
        {#        });#}
        {#        $("input").focus(function () {#}
        {#           console.log("Focusing");#}
        {#        });#}


    </script>

{% endblock %}